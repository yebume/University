# 1 "init1835viaSPI.c"









# 1 "tt.h"









# 1 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\cdef21364.h"






 

 





 





# 1 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"






 













 








# 58 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"


# 107 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"


# 155 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"


# 203 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"


# 217 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"


# 229 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"




# 248 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"







# 303 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"








# 317 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"






















# 346 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"









# 361 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"




 
# 378 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"
































# 421 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"

# 433 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"

# 445 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\Cdef21363.h"

# 22 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\cdef21364.h"

# 11 "tt.h"
# 1 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21364.h"






 










# 1 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



















 


























































































 





# 149 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"








# 185 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 234 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 282 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 330 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 344 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 356 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"




# 375 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"







# 430 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"








# 444 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"






















# 473 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"









# 488 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"





# 505 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"













# 529 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

# 541 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

# 553 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

# 565 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 574 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"





# 600 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 611 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 645 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

# 669 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 680 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

# 691 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 721 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 751 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 780 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 806 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 825 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

# 842 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"








# 867 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 892 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 915 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"






# 941 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"






# 954 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"







# 970 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 986 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1289 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1366 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"







# 1417 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1431 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1440 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1521 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"




























# 1555 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"








# 1583 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1605 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1636 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1651 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1678 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"




# 1708 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 1735 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"




# 1755 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"































# 1794 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"










# 1834 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1861 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 1883 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"






















# 1933 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

 
# 1942 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"







# 1981 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2015 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2026 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2052 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2086 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2120 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 2131 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



# 2158 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


            









# 2202 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2236 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"



 
# 2247 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

 
# 2256 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

 
# 2265 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

 
# 2274 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"

 










 










 










 










 





 





 





 








# 2378 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"


# 2412 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21363.h"











# 19 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\def21364.h"



# 12 "tt.h"
# 1 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"






 




# 40 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"

 

# 86 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"

 
 
# 160 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"

 

# 212 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"

 








# 246 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"
                                

                                
# 264 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"

# 294 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"






 


# 310 "C:\\Program Files\\Analog Devices\\VisualDSP 4.5\\213xx\\include\\signal.h"








 

typedef int sig_atomic_t;





void (*signal(int _sig, void (*func)(int))) (int);
void (*signalf(int _sig, void (*func)(int))) (int);
void (*signals(int _sig, void (*func)(int))) (int);
void (*signalcb(int _sig, void (*func)(int))) (int);
void (*signalss(int _sig, void (*func)(int))) (int);

void (*signalnsm(int _sig, void (*func)(int))) (int);
void (*signalfnsm(int _sig, void (*func)(int))) (int);
void (*signalsnsm(int _sig, void (*func)(int))) (int);
void (*signalcbnsm(int _sig, void (*func)(int))) (int);
void (*signalssnsm(int _sig, void (*func)(int))) (int);

void (*interrupt(int _sig, void (*func)(int))) (int);
void (*interruptf(int _sig, void (*func)(int))) (int);
void (*interrupts(int _sig, void (*func)(int))) (int);
void (*interruptcb(int _sig, void (*func)(int))) (int);
void (*interruptss(int _sig, void (*func)(int))) (int);

void (*interruptnsm(int _sig, void (*func)(int))) (int);
void (*interruptfnsm(int _sig, void (*func)(int))) (int);
void (*interruptsnsm(int _sig, void (*func)(int))) (int);
void (*interruptcbnsm(int _sig, void (*func)(int))) (int);
void (*interruptssnsm(int _sig, void (*func)(int))) (int);

int raise(int);
int raisensm(int);

int clear_interrupt(int _sig);







# 13 "tt.h"











#pragma optimize_off
extern void InitPLL(void);
extern void process(void);

extern void InitDAI(void);
extern void DAIsigInit(void);
extern void setDAIproc(void);
extern void clrDAIproc(void);

extern float conv_asm( float * coef, float * inCur, float * inBase, unsigned int bufSize);	

extern float filter4one(float b[], int N_b, float a[], int N_a, float state[], float memory[], float input);
void LMS(float *coefs_filter, int N, float mu, float* input, int iInd, float* output, int oInd, float *y_est, float *err);

extern void Init1835viaSPI(void);

extern void InitSPORT(void);
extern void receive(int);
extern void ClearSPORT(void);

extern void SetupSPI1835 () ;
extern void DisableSPI1835 () ;
extern void Configure1835Register (int i) ;
extern unsigned int Get1835Register (int i) ;
extern void Init1835viaSPI_PowerDwn();

extern void SetupIRQ12 () ;
extern void Irq1ISR (int i) ;
extern void Irq2ISR (int i) ;

extern void Delay (int i) ;


extern int isProcessing;
extern int dataReady;



extern unsigned int Block_A[2] ;
extern unsigned int Block_B[2] ;
extern unsigned int Block_C[2] ;


extern float rightIn  , leftIn;
extern float rightOut1, leftOut1;
extern float rightOut2, leftOut2;
extern float rightOut3, leftOut3;
extern float rightOut4, leftOut4;

extern int rightIn_i  , leftIn_i;
extern int rightOut1_i, leftOut1_i;
extern int rightOut2_i, leftOut2_i;
extern int rightOut3_i, leftOut3_i;
extern int rightOut4_i, leftOut4_i;






# 11 "init1835viaSPI.c"
# 1 "ad1835.h"















# 31 "ad1835.h"





























# 69 "ad1835.h"




# 79 "ad1835.h"
                                 
                                 
                                 
                                 
                                 















# 105 "ad1835.h"


















# 12 "init1835viaSPI.c"

void SetupSPI1835 (void);
void DisableSPI1835 (void);
void Configure1835Register (int val);
unsigned int Get1835Register (int val);
void Init1835viaSPI(void);
void Init1835viaSPI_PowerDwn(void);


 
unsigned int Config1835Param [] = {
            (0x0000) | (0x0000) | (0x0000) | (0x0000) | (0x0000),
            (0x0000) | (0x1000) ,
            (0x0000) | (0x2000) | (0x3FF),
            (0x0000) | (0x3000) | (0x3FF),
            (0x0000) | (0x4000) | (0x3FF),
            (0x0000) | (0x5000) | (0x3FF),
            (0x0000) | (0x6000) | (0x3FF),
            (0x0000) | (0x7000) | (0x3FF),
            (0x0000) | (0x8000) | (0x3FF),
            (0x0000) | (0x9000) | (0x3FF),
            (0x0000) | (0xC000) | (0x0000),
            (0x0000) | (0xD000) | (0x0000) | (0x0000),
            (0x0000) | (0xE000) | (0x0000)
        } ;

unsigned int Config1835ParamPowerDwn [] = {
            (0x0000) | (0x0000) | (0x0004),
            (0x0000) | (0xC000) | (0x0080),
        } ;
        
volatile int spiFlag ;


void SetupSPI1835 (void)
{
     
     
    *((volatile unsigned int *) 0x1000) = ((0x00040000) | (0x00080000)) ;
    *((volatile unsigned int *) 0x1001) = 0;

     
    *((volatile unsigned int *) 0x1005) = 100;

     
    *((volatile unsigned int *) 0x1001) = 0xF708;

     
    *((volatile unsigned int *) 0x1000) = ((0x00004000) | (0x00001000) | (0x00000200) | (0x00000080) | (0x00000001)) ;

}


void DisableSPI1835 (void)
{
    *((volatile unsigned int *) 0x1000) = ((0x00040000) | (0x00080000));
}


void Configure1835Register (int val)
{
    *((volatile unsigned int *) 0x1003) = val ;
    Delay(100);

    
    while (1)
    {
        if (*((volatile unsigned int *) 0x1002) & (0x00000001))
            break ;
    }
    Delay (100) ;
}


unsigned int Get1835Register (int val)
{
    *((volatile unsigned int *) 0x1003) = val ;
    Delay(100);

    
    while (1)
    {
        if ((0x00000001) & *((volatile unsigned int *) 0x1002))
            break ;
    }
    Delay (100) ;
    return *((volatile unsigned int *) 0x1004) ;

}


void Init1835viaSPI(void)
{
    int configSize = sizeof (Config1835Param) / sizeof (int) ;
    int i ;

    SetupSPI1835 () ;

    for (i = 0; i < configSize; ++i)
    {
        Configure1835Register (Config1835Param[i]) ;
    }

    DisableSPI1835 () ;

}


void Init1835viaSPI_PowerDwn(void)
{
    int configSize = sizeof (Config1835Param) / sizeof (int) ;
    int i ;

    SetupSPI1835 () ;

    for (i = 0; i < configSize; ++i)
    {
        Configure1835Register (Config1835ParamPowerDwn[i]) ;
    }

    DisableSPI1835 () ;

}



void Delay (int i)
{
    for (;i>0;--i)
        asm ("nop;") ;
}
